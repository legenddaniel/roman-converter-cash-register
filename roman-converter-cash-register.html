<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, shrink-to-fit=no">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="ie=edge,chrome=1">
    <meta name="description" content="visualization of small project from online code camp">
    <meta name="keywords" content="roman converter, cash register">
    <title>Roman Converter & Cash Register</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.css">
    <link rel="stylesheet" href="roman-converter-cash-register.css">
</head>

<body>

    <!-- off()没用解决办法，解决后可应用于body click和window resize -->

    <!-- firefox问题：cash页面乱-->

    <div class="modal fade github text-center" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">You are heading to another website</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    Github.com will be opened in a new tab
                </div>
                <div class="modal-footer text-nowrap">
                    <a href="#" class="mr-3 text-secondary" data-dismiss="modal">No</a>
                    <a href="https://github.com/legenddaniel/roman-converter-cash-register" target="_blank"
                        class="btn btn-primary">Go <i class="fab fa-github"></i></a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade wiki text-center" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">You are heading to another website</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    Wiki.org will be opened in a new tab
                </div>
                <div class="modal-footer text-nowrap">
                    <a href="#" class="mr-3 text-secondary" data-dismiss="modal">No</a>
                    <a href="https://en.wikipedia.org/wiki/Roman_numerals" target="_blank" class="btn btn-primary">Go <i
                            class="fab fa-wikipedia-w"></i></a>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade history-roman text-center" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">History</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <table class="table table-hover">
                        <thead class="thead-light">
                            <tr>
                                <th scope="col">Input</th>
                                <th scope="col">Output</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="modal-footer text-nowrap">
                    <button type="button" class="clear-history btn btn-link">Clear history</button>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid text-center h-100 min-vh-100">
        <header>
            <nav class="d-flex pt-5">
                <a class="mobile" href="#">&#9776;</a>
                <ul class="nav nav-pills offset-lg-3 offset-sm-2 offset-1">
                    <li class="nav-item">
                        <a class="nav-link navbar-brand active" href=".tab-about" data-toggle="pill">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href=".tab-roman" data-toggle="pill" tabindex="-1">Roman
                            Converter</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link disabled" href=".tab-cash" data-toggle="pill" tabindex="-1">Cash Register</a>
                    </li>
                </ul>
            </nav>
            <div class="eye" data-toggle="tooltip" data-placement="left" title="bg-animation">
                <i class="fas fa-eye-slash text-danger"></i>
            </div>
        </header>
        <div class="tab-content">
            <div class="tab-pane tab-about active">
                <div class="row justify-content-center">
                    <div class="col-lg-8 col-sm-10">
                        <main class="card card-body">
                            <div class="progress mb-4">
                                <div class="progress-bar bg-info"></div>
                                <span class="text-nowrap">0%</span>
                            </div>
                            <p class="card-text">
                                <span class="browser bg-warning"><strong>Are you using browsers from Microsoft? Try the
                                        latest version
                                        of Chrome/Firefox/Safari/Opera. No offense but IE/Edge has bad support on ES6+
                                        features.</strong><br><br><em class="bg-light">Update: The new Chromium
                                        Microsoft Edge was
                                        released on Jan 15 2020, ummmmmm
                                        well...</em></span><br><br>
                                This page has two modules: a roman numerals converter and a cash register simulation.
                                Both are small projects from my self-learning tutorial. <br><br>You can click <button
                                    type="button" class="btn btn-sm btn-info" disabled tabindex="-1"><i
                                        class="fas fa-history"></i></button> to see the history for each component.
                                <br><br>More information on my <a data-toggle="modal" href=".github"
                                    class="text-danger">Github</a>
                            </p>
                        </main>
                    </div>
                </div>
            </div>
            <div class="tab-pane tab-roman">
                <div class="row justify-content-center">
                    <div class="col-lg-8 col-sm-10">
                        <main class="card card-body">
                            <div class="d-flex justify-content-center align-items-end mb-1">
                                <p class="card-text flex-grow-1">Please input ↓ </p>
                                <span class="btn-history" data-toggle="modal" data-target=".history-roman">
                                    <button type="button" class="btn btn-lg btn-info" data-toggle="tooltip"
                                        data-placement="top" title="History"><i class="fas fa-history"></i></button>
                                </span>
                            </div>
                            <div class="input-container form-row justify-content-around align-items-center">
                                <div class="input-group col-sm-8 col-md-6">
                                    <input type="search" class="input-roman form-control text-center"
                                        title="Roman or Arabic numerals" placeholder="case-insensitive">
                                    <div class="input-group-append">
                                        <button class="get-roman btn btn-outline-secondary" type="button">→</button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group form-inline mt-3">
                                <label for="output-roman" class="col-md-4">Output:</label>
                                <input type="text" id="output-roman" placeholder="click '→' to get the result"
                                    class="col-md-4 form-control-plaintext text-center" readonly>
                            </div>
                            <a href="#roman-more" class="card-link" data-toggle="collapse" draggable="false">No idea
                                about roman numerals?</a>
                            <div class="collapse" id="roman-more">
                                <div class="card card-body">
                                    <blockquote
                                        cite="https://en.wikipedia.org/wiki/Roman_numerals#%22Standard%22_forms">
                                        Roman numerals are a numeral system that originated in ancient Rome and remained
                                        the usual way of writing numbers throughout Europe well into the Late Middle
                                        Ages. Numbers in this system are represented by combinations of letters from the
                                        Latin alphabet. Modern usage employs seven symbols, each with a fixed integer
                                        value:
                                    </blockquote>
                                    <div class="table-responsive">
                                        <table class="table table-borderless">
                                            <tbody>
                                                <tr>
                                                    <th scope="row" class="table-info">Symbol</th>
                                                    <td>I</td>
                                                    <td>V</td>
                                                    <td>X</td>
                                                    <td>L</td>
                                                    <td>C</td>
                                                    <td>D</td>
                                                    <td>M</td>
                                                </tr>
                                                <tr>
                                                    <th scope="row" class="table-info">Value</th>
                                                    <td>1</td>
                                                    <td>5</td>
                                                    <td>10</td>
                                                    <td>50</td>
                                                    <td>100</td>
                                                    <td>500</td>
                                                    <td>1000</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <p>Still confused? Read more on <a data-toggle="modal" href=".wiki"
                                            class="card-link text-danger">Wikipedia</a>
                                    </p>
                                </div>
                            </div>
                        </main>
                    </div>
                </div>
            </div>
            <div class="tab-pane tab-cash">
                <div class="row justify-content-center">
                    <div class="col-lg-8 col-sm-10">
                        <main class="card card-body">
                            <p class="card-text text-left jumbotron">This module is designed as a game mode:
                                <br><br>The
                                numbers right after the cash/coin imgs are the amount of cash/coin remaining in the cash
                                register.
                                <br><br>Click the button to randomly draw a total and received amount.
                                Calculate the change and check if we can make it or not.
                                <br><br>The result will be
                                shown as Bootstrap Badges right after the balance for each face value of cash/coin.
                                <br><br>You can reset your score, which is retained even after you close this page, to 0
                                by clicking the score button at any time.
                                <br><br>
                                <strong>P.S. If no more cash with a face value less than the change we take it as a
                                    failure
                                    <br><em>e.g. the change due is $1.03 but we got only loonies and
                                        nickels. </em>
                                    <br>This is why we introduced the discontinued penny "1¢" here
                                    which is for a simplification purpose.</strong>
                            </p>
                            <p>Click <button type="button" class="btn btn-sm btn-success" disabled tabindex="-1"><i
                                        class="fas fa-hammer"></i></button> to (re)set the value, click <button
                                    type="button" class="btn btn-sm btn-info" disabled tabindex="-1">&times;</button> to
                                clear the
                                score</p>
                            <div class="form-group form-inline justify-content-center align-items-center">
                                <div class="col-md-3 col-sm-6 d-flex align-items-center">
                                    <label for="total">Total:</label>
                                    <input type="text" id="total" class="form-control-plaintext text-center bg-light"
                                        readonly>
                                </div>
                                <div class="col-md-3 col-sm-6 d-flex align-items-center">
                                    <label for="received">Received:</label>
                                    <input type="text" id="received" class="form-control-plaintext text-center bg-light"
                                        readonly>
                                </div>
                                <button type="button" class="btn-set btn btn-lg btn-success"><i
                                        class="fas fa-hammer"></i></button>
                                <button type="button" class="btn-score btn btn-lg btn-info"><span></span></button>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-lg-4 col-sm-6">
                                    <p class="card-text">Banknotes</p>
                                    <ul class="ul-banknotes list-unstyled">
                                        <li>
                                            <span class="icon-banknote">$5</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                        <li>
                                            <span class="icon-banknote">$10</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                        <li>
                                            <span class="icon-banknote">$20</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                        <li>
                                            <span class="icon-banknote">$50</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-lg-4 col-sm-6">
                                    <p class="card-text">Coins</p>
                                    <ul class="ul-coins list-unstyled">
                                        <li>
                                            <span class="icon-coin">1¢</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                        <li>
                                            <span class="icon-coin">5¢</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                        <li>
                                            <span class="icon-coin">10¢</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                        <li>
                                            <span class="icon-coin">25¢</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                        <li>
                                            <span class="icon-coin">$1</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                        <li>
                                            <span class="icon-coin">$2</span>
                                            <span class="icon-mtp">*</span>
                                            <span class="qty-denom"></span>
                                            <span class="badge badge-light"> </span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="answer form-inline justify-content-center mb-3"
                                data-text="Do you think we can make this?">
                                <div class="custom-control custom-switch ml-3 mr-5">
                                    <input type="checkbox" class="custom-control-input" id="answer">
                                    <label class="custom-control-label text-nowrap" for="answer">No</label>
                                </div>
                                <button type="button" class="btn btn-primary">See the answer</button>
                            </div>
                            <div class="alert col-lg-6 col-8 mx-auto text-nowrap">
                                <span></span>
                                <button type="button" class="close">&times;</button>
                            </div>
                        </main>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script>
        // Public methods

        const methodsMain = {

            initCache: function (item) {
                if (item === 'historyRoman') {
                    return this.getProp('historyRoman') || { "input": [], "output": [] };
                } else if (item === 'scoreCash') {
                    return this.getProp('scoreCash') || { "correct": 0, "total": 0, "score": 0 }
                }
            },

            getProp: (item, prop) => {
                try {
                    const cacheProp = JSON.parse(localStorage.getItem(item))[prop];
                    if (prop && cacheProp) {
                        return cacheProp;
                    } else if (!prop) {
                        return JSON.parse(localStorage.getItem(item));
                    }
                    return 0;
                } catch(e) { // Identifier 'e' only for IE/Edge support
                    return 0;
                };
            },

            setVal: (item, val) => {
                return localStorage.setItem(item, JSON.stringify(val));
            },

            clearProp: item => {
                if (item === 'historyRoman') {
                    ifNoHistory();
                } else if (item === 'scoreCash') {
                    ifNoScore();
                }
                localStorage.removeItem(item);
            },

            setScoreHtml: () => {
                return (
                    `Current:<br>
                    { "correct": ${methodsMain.getProp('scoreCash', 'correct')}, "total": ${methodsMain.getProp('scoreCash', 'total')}, "score": ${methodsMain.getProp('scoreCash', 'score')}% }`
                );
            },

            ifResize: fn => {
                fn();
                $(window).on('resize', fn);
            },
        };

        const methodsMenu = {
            _selector: 'nav ul',
            _offset: 'offset-lg-3 offset-sm-2 offset-1',
            _other: 'flex-column bg-light',
            _css1: {
                'display': 'none',
                'position': 'absolute',
                'top': '5rem',
                'left': '15px',
                'z-index': 1,
            },
            _css2: {
                'display': '',
                'position': '',
                'top': '',
                'left': '',
                'transform': '',
                'z-index': ''
            },
            _cssNav: 'flex-column align-items-start',
            isXs: () => $(window).width() < 576,
            setStyle: function (selector, remove, add, css) {
                try {
                    $(this[selector]).removeClass(this[remove]).addClass(this[add]).css(this[css]);
                } catch(e) { // Identifier 'e' only for IE/Edge support
                    $(selector).removeClass(remove).addClass(add).css(css);
                }
            },
            setMr: (selector, mr) => {
                $(selector).css('margin-right', mr);
            },
            setIfXs: function () {
                const hide = () => {
                    $('nav ul').hide();
                };
                $('.mobile').show();
                $('nav').addClass(this._cssNav);
                $('body').on('click', hide);
                $('nav li').on('hover', e => {
                    $(e.currentTarget).css('background-color', 'steelblue');
                });
            },
            setUnlessXs: function () {
                $('.mobile').hide();
                $('nav').removeClass(this._cssNav);
                $('body').off('click');
            },
        };

        const methodsAnimation = {
            setAnimation: (selector, animation) => {
                $(selector).css({ 'animation': animation, '-webkit-animation': animation })
            },
            animationCtrl: (selector, status) => {
                $(selector).css({ 'animation-play-state': status, '-webkit-animation-play-state': status });
            },
        };

    </script>
    <script>
        // Initialization of some html/bootstrap components

        $(() => {

            const setMenu = () => {

                // It is better to set style in .css by media query, but here we can use public method to set the style with other preseted Bootstrap styles together which is more convenient
                if (methodsMenu.isXs()) {
                    methodsMenu.setIfXs();
                    methodsMenu.setStyle('_selector', '_offset', '_other', '_css1');
                    methodsMenu.setMr('.navbar-brand', 0);
                } else {
                    methodsMenu.setUnlessXs();
                    methodsMenu.setStyle('_selector', '_other', '_offset', '_css2');
                    methodsMenu.setMr('.navbar-brand', '1rem');
                }
            };

            $('.btn-score span').text(`Score: ${methodsMain.getProp('scoreCash', 'score')}%`);

            $('.eye, .btn-history button').tooltip();

            $('.clear-history').popover({
                placement: 'bottom',
                html: true,
                title: 'You are cleaning the history',
                content: `
                <div>
                    <span>All records will be removed &nbsp;&nbsp;</span>
                    <a class="confirm-clear-history btn btn-sm btn-danger">Yes</a>
                    <a class="btn btn-sm btn-link">No</a>
                </div>
            `
            })
            $('.btn-score').popover({
                placement: 'bottom',
                html: true,
                title: 'You are resetting the score',
                content: () => {
                    return (
                        `<div>
                            <span>Score will be restored to 0 &nbsp;&nbsp;</span>
                            <a class="confirm-clear-score btn btn-sm btn-danger">Yes</a>
                            <a class="btn btn-sm btn-link">No</a>
                        </div>
                        <p class="current-score">${methodsMain.setScoreHtml()}</p>
                        `
                    );
                },
            });
            $('body').on('shown.bs.popover', () => {
                $('.popover-body a').on('click', () => {
                    $('.clear-history, .btn-score').popover('hide');
                })
            })

            methodsMain.ifResize(setMenu);

            $('.mobile').on('click', e => {
                $('nav ul').toggle();
                e.stopPropagation();
            })
        })
    </script>
    <script src="progress-bar.js"></script>
    <script>
        // Browser functioning detection

        $(() => {

            // So far all good for userAgent but I will try to avoid it in the future
            const getVersion = navigator.userAgent;
            const browsers = {

                // Few browsers support lookbehinds
                _android: {
                    regex: /Android\s(\d{1,2})/,
                    version: '4.4',
                },
                _safari: {
                    regex: /(?:Mac|iPhone|iPad|iPod).*Version\/(\d{1,2})/,
                    version: 9,
                },
                _chrome: {
                    regex: /(?:Chrome\/|CriOS\/)(\d{1,2})/,
                    version: 45,
                },
                _firefox: {
                    regex: /(?:Firefox\/|FxiOS\/)(\d{1,2})/,
                    version: 38,
                },
                _opera: {
                    regex: /(?:OPR\/)(\d{1,2})/,
                    version: 30,
                },
            };
            const regMS = /Trident|Edge/;
            const text = {
                'incompatible': 'Try the latest version of your browser to see how strong the new Bootstrap 4 is!',

                'compatible': "Your browser looks cool. Let's kick it off!",

                'localstorage': 'It is detected that localStorage cannot be loaded. \n You may update your browser to the latest version or check if you are in private/anonymous/incognito browsing, or the history as well as score functions will not be working. \n The data between regular browsing and private-style browsing may not be sharing.'
            };
            const checkCompatibility = () => {
                for (let browser in browsers) {
                    Object.defineProperty(browsers[browser], 'compatibility', {
                        writable: true,
                        configurable: true,
                        enumerable: false,
                        value: (() => {
                            try {
                                return getVersion.match(browsers[browser].regex)[1] >= browsers[browser].version;
                            } catch(e) { // Identifier 'e' only for IE/Edge support
                                return false;
                            }
                        })(),
                    });
                };
                for (let browser in browsers) {
                    if (browsers[browser].compatibility) {
                        return true;
                    }
                }
                return false;
            };
            const setAbout = (selector, text, remove, add) => {
                $(selector).text(text).removeClass(remove).addClass(add);
            };

            if (localStorage) {
                if (checkCompatibility()) {
                    setAbout('.browser', text.compatible, 'bg-warning', 'bg-success');
                } else if (!checkCompatibility() && !regMS.test(getVersion)) {
                    setAbout('.browser', text.incompatible, 'bg-success', 'bg-warning');
                }
            } else {
                setAbout('.browser', text.localstorage, 'bg-success', 'bg-warning');
            }
        });

    </script>
    <script>
        // Tabs show and hide on the index

        $('.nav-link').not('.navbar-brand').on('click', () => {
            const fade = () => {
                if (methodsMenu.isXs()) {
                    methodsAnimation.setAnimation('.navbar-brand', '');
                } else {
                    methodsAnimation.setAnimation('.navbar-brand', 'fade 1.5s reverse');
                }
            };
            $('.nav-link').not('.navbar-brand').css({ 'animation': 'none', '-webkit-animation': 'none' });
            $('.navbar-brand')
                .html('<i class="fab fa-windows"></i>')
                .removeClass('disabled')
                .prop('tabindex', '0');
            $('.progress span').text('Loaded');
            methodsMain.ifResize(fade);
        });
    </script>
    <script>
        // Background animation switch
        // Due to the browser prefix for animation, $.toggleClass() now working well

        $('.eye').on('click', e => {
            const eyeRed = '<i class="fas fa-eye-slash text-danger"></i>';
            const eyeGreen = '<i class="far fa-eye text-success"></i>';

            if ($(e.currentTarget).html() === eyeGreen) {
                $(e.currentTarget).html(eyeRed);
                methodsAnimation.animationCtrl('.container-fluid', 'running');
            } else {
                $(e.currentTarget).html(eyeGreen);
                methodsAnimation.animationCtrl('.container-fluid', 'paused');
            }
        });
    </script>
    <script src="roman-converter.js"></script>
    <script>
        // Converter main functions
        {
            let clickCount = 0;
            $('.get-roman').on('click', () => {
                const inputVal = $('.input-roman').val();
                const testVal = reg => reg.test(inputVal);
                const regNum = /^[1-3]\d{0,3}$|^[4-9]\d{0,2}$/; // 1-3999
                const regRoman = /^m{0,3}(cd|cm|d?c{0,3})(xl|xc|l?x{0,3})(iv|ix|v?i{0,3})$/i;
                const ifValid = () => {
                    clickCount = 0;
                    $('#output-roman').addClass('bg-light');
                }
                const ifInvalid = () => {
                    $('#output-roman')
                        .val('')
                        .removeClass('bg-light')
                        .prop('placeholder', 'Invalid value, please try again');
                    clickCount >= 2 ? $('#output-roman').prop('placeholder', 'Check the link below for help') : clickCount++;
                }

                if (testVal(regNum)) {
                    $('#output-roman').val(convertToRoman(inputVal));
                    ifValid();
                } else if (testVal(regRoman) && inputVal.length) {
                    $('#output-roman').val(convertToNum(inputVal));
                    ifValid();
                } else {
                    ifInvalid();
                }

                return getValid = () => inputVal.length && (testVal(regNum) || testVal(regRoman));
            })
        }
    </script>
    <script src="cash-register-new.js"></script>
    <script>
        {
            // Cash register question part

            $('.btn-set').on('click', () => {

                $('.qty-denom').css('visibility', 'visible');
                $('.qty-denom + span').not(':contains(0)').css('visibility', 'hidden');
                $('.alert').css('visibility', 'hidden');
                $('#answer').prop({ 'disabled': false, 'tabindex': '0' });
                $('.answer').attr('data-text', 'Do you think we can make this?');

                // For easy calculation we assume the total amount is under $100 and the face value of the received cash is just greater than the total amount
                $('#total').val((Math.random() * 99.51 + 0.5).toFixed(2));
                $('#received').val(Object.values(currency).find(denom => denom >= $('#total').val()) || 100);

                const generator = (...setAmt) => {
                    // Generates random amount of cash, be cautious that the order of the denomination (setAmt) is per the order of icons (i.e. starting from $5) on the webpage rather than of the Object 'currency' above
                    const cacheQty = setAmt.map(i => Math.floor(Math.random() * (i + 1)));
                    return [cacheQty.slice(0, 4), cacheQty.slice(4)];
                };
                const qty = generator(2, 5, 3, 1, 8, 2, 8, 6, 8, 4);
                const setDenom = () => {
                    for (let i = 0; i < qty[0].length; i++) {
                        $(`.ul-banknotes li:eq(${i}) span.qty-denom`).text(qty[0][i]);
                    }
                    for (let i = 0; i < qty[1].length; i++) {
                        $(`.ul-coins li:eq(${i}) span.qty-denom`).text(qty[1][i]);
                    }
                };
                setDenom();
                return getQty = () => [...qty[1], ...qty[0]]; // Re-order the array
            })

            $('body').on('shown.bs.popover', () => {
                $('.confirm-clear-score').on('click', () => {
                    methodsMain.clearProp('scoreCash');
                })
            })
        }

    </script>
    <script>
        //Cash register answer part
        {
            const setScoreCash = (() => {
                return ifNoScore = () => {
                    for (let i in cacheScoreCash) {
                        cacheScoreCash[i] = 0;
                    }
                    $('.btn-score span').text('Score: 0%');
                };
            })();

            const cacheScoreCash = methodsMain.initCache('scoreCash');

            $('#answer').on('change', e => {
                $(e.currentTarget).is(':checked') ? $('.answer label').text('Yes') : $('.answer label').text('No');
            });

            $('.answer button').on('click', () => {

                const setCid = () => {
                    const cid = [];
                    const qty = getQty();
                    const denom = Object.keys(currency);
                    for (let i = 0; i < qty.length; i++) {
                        cid.push([denom[i], qty[i]]);
                    }
                    return cid;
                };
                const cacheResult = checkCashRegister($('#total').val(), $('#received').val(), setCid());

                // The order of the denomination is the same as on the webpage
                const result = [...cacheResult.slice(6), ...cacheResult.slice(0, 6)];
                const isChecked = $('#answer').prop('checked');
                const changeDue = result.some(i => i);

                const setResult = () => {
                    for (let i = 0; i < result.length; i++) {
                        $(`.qty-denom:eq(${i}) + .badge`).text(result[i]);
                    }
                    $('.qty-denom + span').not(':contains(0)').css('visibility', 'visible');
                };
                if (changeDue) {
                    setResult();
                }

                const setAlert = (text, ...setPropParameters) => {
                    $('.alert span').text(text);
                    methodsMenu.setStyle('.alert', ...setPropParameters, { 'visibility': 'visible' });
                };
                if ($('.answer').attr('data-text') === 'Do you think we can make this?') {
                    if (!(isChecked ^ changeDue)) {
                        cacheScoreCash.correct++;
                        setAlert('You got it!', 'alert-danger alert-warning', 'alert-success');
                    } else {
                        setAlert('Goose egg!', 'alert-success alert-warning', 'alert-danger');
                    }
                    cacheScoreCash.total++;
                    cacheScoreCash.score = Math.round(100 * cacheScoreCash.correct / cacheScoreCash.total);
                } else {
                    setAlert("Let's move on to the next!", 'alert-danger alert-success', 'alert-warning');
                }
                methodsMain.setVal('scoreCash', cacheScoreCash);

                $('.btn-score span').text(`Score: ${cacheScoreCash.score}%`);
                $('#answer').prop({ 'disabled': true, 'tabindex': '-1' });
                $('.answer').attr('data-text', '(Re)set the values to continue');
                $('.current-score').html(methodsMain.setScoreHtml());
            });

            $('.tab-cash .alert .close').on('click', e => {
                $(e.currentTarget).parent().css('visibility', 'hidden');
            });
        }
    </script>
    <script>
        // Roman coverter history
        {
            const cacheHistoryRoman = methodsMain.initCache('historyRoman');
            const setHistoryRoman = (() => {
                return ifNoHistory = () => {
                    $('.history-roman tbody').html('<tr><td colspan="2" class="text-center">No history</td></tr>');
                    for (let key in cacheHistoryRoman) {
                        cacheHistoryRoman[key].length = 0;
                    }
                };
            })();

            $('.get-roman').on('click', () => {
                if (getValid() && $('.input-roman').val() !== [...cacheHistoryRoman['input']].pop()) {
                    cacheHistoryRoman['input'].push($('.input-roman').val());
                    cacheHistoryRoman['output'].push($('#output-roman').val());
                    methodsMain.setVal('historyRoman', cacheHistoryRoman);
                }
            })
            $('.btn-history button').on('click', () => {
                if (!cacheHistoryRoman['input'].length) {
                    ifNoHistory();
                } else {
                    $('.history-roman tbody').empty();
                    for (let i = 0; i < cacheHistoryRoman['input'].length; i++) {
                        $('.history-roman tbody')
                            .append('<tr></tr>')
                            .children('tr').eq(i).append(
                                `<td>${cacheHistoryRoman['input'][i]}</td>
                                <td>${cacheHistoryRoman['output'][i]}</td>`
                            );
                    }
                }
            })
            $('body').on('shown.bs.popover', () => {
                $('.confirm-clear-history').on('click', () => {
                    methodsMain.clearProp('historyRoman');
                })
            });
        }
    </script>
</body>

</html>